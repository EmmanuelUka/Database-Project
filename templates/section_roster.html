<!DOCTYPE html>
<html>
<head>
    <title>Section Roster</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 30px;
        }
        h2, h3 {
            margin-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }
        th {
            background: #f2f2f2;
        }
        form {
            display: inline-block;
            margin: 0;
            padding: 0;
        }
        .grade-select {
            padding: 4px;
        }
        .btn {
            padding: 6px 10px;
            border: none;
            cursor: pointer;
            border-radius: 4px;
        }
        .btn-update {
            background-color: #007bff;
            color: white;
        }
        .btn-remove {
            background-color: #c82333;
            color: white;
        }
        .btn-update:hover {
            background-color: #0069d9;
        }
        .btn-remove:hover {
            background-color: #a71d2a;
        }
    </style>
</head>

<body>

    <h2>Section Roster</h2>
    <h3>
        {{ section.course_id }} - {{ section.c_name }}<br>
        Section {{ section.section_number }} â€” {{ section.semester }} {{ section.year }}
    </h3>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <ul>
          {% for msg in messages %}
            <li style="color: green; font-weight: bold;">{{ msg }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    <table>
        <tr>
            <th>Student ID</th>
            <th>Name</th>
            <th>Email</th>
            <th>Current Grade</th>
            <th>Update Grade</th>
            <th>Remove</th>
        </tr>

        {% for student in students %}
        <tr>
            <td>{{ student.student_id }}</td>
            <td>{{ student.s_name }}</td>
            <td>{{ student.email }}</td>
            <td>{{ student.letter if student.letter else "-" }}</td>

            <!-- Grade Update -->
            <td>
                <form action="{{ url_for('update_grade', course_id=section.course_id, section_number=section.section_number) }}" method="POST">
                    <input type="hidden" name="student_id" value="{{ student.student_id }}">

                    <select name="grade" class="grade-select">
                        <option value="">--</option>
                        <option value="A"  {% if student.letter == 'A' %}selected{% endif %}>A</option>
                        <option value="A-" {% if student.letter == 'A-' %}selected{% endif %}>A-</option>
                        <option value="B+" {% if student.letter == 'B+' %}selected{% endif %}>B+</option>
                        <option value="B"  {% if student.letter == 'B' %}selected{% endif %}>B</option>
                        <option value="B-" {% if student.letter == 'B-' %}selected{% endif %}>B-</option>
                        <option value="C+" {% if student.letter == 'C+' %}selected{% endif %}>C+</option>
                        <option value="C"  {% if student.letter == 'C' %}selected{% endif %}>C</option>
                        <option value="C-" {% if student.letter == 'C-' %}selected{% endif %}>C-</option>
                        <option value="D"  {% if student.letter == 'D' %}selected{% endif %}>D</option>
                        <option value="F"  {% if student.letter == 'F' %}selected{% endif %}>F</option>
                    </select>

                    <button type="submit" class="btn btn-update">Update</button>
                </form>
            </td>

            <!-- Remove Student -->
            <td>
                <form action="{{ url_for('remove_student', course_id=section.course_id, section_number=section.section_number) }}" method="POST" onsubmit="return confirm('Remove this student from the section?');">
                    <input type="hidden" name="student_id" value="{{ student.student_id }}">
                    <button type="submit" class="btn btn-remove">Remove</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>

    <br>
    <a href="{{ url_for('instructor_sections') }}">&larr; Back to Semesters</a>

</body>
</html>
